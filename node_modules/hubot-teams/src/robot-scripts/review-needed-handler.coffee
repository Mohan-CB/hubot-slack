# Description
#   Message AOs and persist review info on review-needed events
AOHelper = require '../ActiveOwnerHelper'
PullRequest = require '../PullRequest'

module.exports = (robot) ->

  helper = new AOHelper robot
  
  robot.on 'github.pull_request.labeled', (pullRequest) ->
    if pullRequest.label.name == process.env.HUBOT_REVIEW_NEEDED_LABEL
      review = new PullRequest(pullRequest)
      helper.addReview(review)
      message = "Rapid Response needs a review of #{review.url}"
      helper.messageAOs(message)
